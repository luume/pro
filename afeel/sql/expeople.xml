<?xml version="1.0" encoding="UTF-8" ?>
<query>
    <myquery id="endMatchList">
        SELECT qq.chatroomNo AS chatroomNo, qq.chatroomRegDate AS chatroomRegDate, qq.rank AS rank, qq.memberNo AS memberNo,
        qq.partnerGender FROM (
        SELECT z.chatroomNo AS chatroomNo, z.chatroomRegDate AS chatroomRegDate, z.rank AS rank, z.memberNo AS memberNo,
        IF((select memberGender FROM MEMBER where memberNo = ?) = 'M' , 'W' , 'M') as partnerGender FROM
        (
        SELECT  croom.chatroomNo AS chatroomNo, croom.chatroomRegDate AS chatroomRegDate, crank.rank AS rank, crank.memberNo AS memberNo,
        IF((select memberGender FROM MEMBER where memberNo = ?) = 'M' , 'W' , 'M') as partnerGender FROM CHAT_RANK crank JOIN CHATROOM croom
        ON croom.chatroomNo = crank.chatroomNo
        )  z JOIN (select c.chatroomNo AS chatroomNo from CHAT_RANK cr JOIN CHATROOM c ON cr.chatroomNo = c.chatroomNo WHERE memberNo = ?) x ON z.chatroomNo = x.chatroomNo
        WHERE z.rank = (IF((select memberGender FROM MEMBER where memberNo = ?) = 'M', 0, 1 ))
        ) qq
    </myquery>

    <myquery id="myRank">
        SELECT rank FROM CHAT_RANK a JOIN CHATROOM b ON a.chatroomNo = b.chatroomNo WHERE memberNo = ?
    </myquery>

</query>


